<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZPRINT v2.7 – Work Order</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  max-width: 560px;
}

label {
  display: block;
  margin-top: 14px;
  font-weight: bold;
}

select, input, button {
  width: 100%;
  padding: 8px;
  margin-top: 4px;
  box-sizing: border-box;
}

button {
  margin-top: 18px;
}

#result {
  margin-top: 20px;
}
</style>
</head>

<body>

<h2>ZPRINT v2.7 – Work Order</h2>

<label>Category</label>
<select id="category"></select>

<label>Subcategory</label>
<select id="subcategory"></select>

<label>Client Name</label>
<input id="client">

<label>Client Phone</label>
<input id="phone">

<label>Description</label>
<input id="description">

<label>Version</label>
<input id="version" value="v0">

<button id="generateBtn" type="button">Generate</button>

<div id="result" style="display:none">
  <p><strong>Generated Filename</strong></p>
  <input id="filename" readonly>
  <button type="button" onclick="copyFilename()">COPY</button>
</div>

<script>
/* ===============================
   CONFIG
================================ */
const SCRIPT_URL = ‘https://script.google.com/macros/s/AKfycbwkE9WHkiSqjMZBZsUYIF0BH3ivgbevnYzjqFzvCo0d-gBkje-_-fCwZmOs8vOtAxhO/exec’;

/* ===============================
   FULL v2.6 CATEGORY MASTER
================================ */
const CATEGORIES = {

  PVC: {
    label: "PVC",
    subs: {
      CLEAR: "Clear",
      PRC: "Print & Cut",
      UV: "UV",
      UVPC: "UV Print & Cut",
      CUT: "Cutting",
      PLN: "Plain",
      GLDC: "Gold Cutting",
      GLDP: "Gold Plain",
      ECO: "Eco",
      CLRPRC: "Clear Print & Cut",
      FRPL: "Frost Plain",
      FRCUT: "Frost Cut",
      FRPRC: "Frost Print & Cut",
      MAG: "Magnet"
    }
  },

  EMB: {
    label: "Embroidery",
    subs: {
      STD: "Standard",
      PRM: "Premium"
    }
  },

  CAN: {
    label: "Canvas",
    subs: {
      COT: "Cotton",
      UV: "UV",
      ECO: "Eco",
      OTH: "Other"
    }
  },

  BAN: {
    label: "Banner",
    subs: {
      UV: "UV",
      ECO: "Eco",
      TD: "Tear Drop",
      FECO: "Flag Eco",
      FUV: "Flag UV",
      POP: "POP",
      STD: "Standard",
      PRM: "Premium"
    }
  },

  MAP: {
    label: "Map",
    subs: {
      NRM: "Normal",
      PP: "PP",
      POP: "POP"
    }
  },

  SUB: {
    label: "Sublimation",
    subs: {
      SUB: "Sublimation"
    }
  },

  DTF: {
    label: "DTF",
    subs: {
      DTF: "DTF"
    }
  },

  CON: {
    label: "Contra",
    subs: {
      UV: "UV",
      ECO: "Eco",
      PLN: "Plain"
    }
  },

  FLT: {
    label: "Flatbed",
    subs: {
      UVD: "UV_DTF",
      PEN: "Pen",
      NOTE: "Notebook",
      ACR: "Acrylic"
    }
  },

  PUB: {
    label: "Publications",
    subs: {
      FLY: "Flyer",
      BR: "Brochure",
      BC: "Business Card",
      OTH: "Other"
    }
  },

  CUS: {
    label: "Custom",
    subs: {
      CUS: "Custom Input"
    }
  }

};

/* ===============================
   ELEMENTS
================================ */
const category = document.getElementById("category");
const subcategory = document.getElementById("subcategory");

/* ===============================
   INIT DROPDOWNS (PROVEN)
================================ */
category.innerHTML = "<option value=''>Select Category</option>";
subcategory.innerHTML = "<option value=''>Select Subcategory</option>";

Object.keys(CATEGORIES).forEach(cat => {
  const opt = document.createElement("option");
  opt.value = cat;
  opt.textContent = `${cat} – ${CATEGORIES[cat].label}`;
  category.appendChild(opt);
});

category.onchange = () => {
  subcategory.innerHTML = "<option value=''>Select Subcategory</option>";
  const subs = CATEGORIES[category.value]?.subs || {};

  Object.keys(subs).forEach(sub => {
    const opt = document.createElement("option");
    opt.value = sub;
    opt.textContent = `${sub} – ${subs[sub]}`;
    subcategory.appendChild(opt);
  });
};

/* ===============================
   GENERATE
================================ */
document.getElementById("generateBtn").onclick = async () => {

  const params = new URLSearchParams({
    action: "createWO",
    category: category.value,
    subcategory: subcategory.value,
    client: client.value,
    phone: phone.value,
    description: description.value,
    version: version.value || "v0"
  });

  const res = await fetch(`${SCRIPT_URL}?${params}`);
  const data = await res.json();

  filename.value = data.filename;
  document.getElementById("result").style.display = "block";
};

/* ===============================
   COPY
================================ */
function copyFilename() {
  filename.select();
  document.execCommand("copy");
}
</script>

</body>
</html>
