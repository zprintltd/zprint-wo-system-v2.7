<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZPRINT v2.7 – Work Order</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;padding:20px;max-width:560px}
label{display:block;margin-top:14px;font-weight:bold}
select,input,button{width:100%;padding:8px;margin-top:4px}
button{margin-top:18px}
#result{margin-top:20px}
</style>
</head>
<body>

<h2>ZPRINT v2.7 – Work Order</h2>

<form id="woForm">
  <label>Category</label>
  <select id="category" required></select>

  <label>Subcategory</label>
  <select id="subcategory" required></select>

  <label>Client</label>
  <input id="client" required>

  <label>Phone</label>
  <input id="phone">

  <label>Description</label>
  <input id="description">

  <label>Version</label>
  <input id="version" value="v0">

  <button type="submit">Generate</button>
</form>

<div id="result" style="display:none">
  <p><b>Filename</b></p>
  <input id="filename" readonly>
  <button type="button" id="copyBtn">COPY</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const SCRIPT_URL = "PASTE_V2_7_EXEC_URL_HERE";

  const CATEGORIES = {
    PVC:{subs:{CLEAR:"Clear",PRC:"Print & Cut",UV:"UV",UVPC:"UV Print & Cut",MAG:"Magnet"}},
    EMB:{subs:{STD:"Standard",PRM:"Premium"}},
    BAN:{subs:{STD:"Standard",PRM:"Premium"}},
    DTF:{subs:{DTF:"DTF"}},
    MAP:{subs:{NRM:"Normal"}},
    CUS:{subs:{CUS:"Custom"}}
  };

  const category = document.getElementById("category");
  const subcategory = document.getElementById("subcategory");
  const form = document.getElementById("woForm");
  const filename = document.getElementById("filename");
  const result = document.getElementById("result");

  // INIT
  category.innerHTML = "<option value=''>Select Category</option>";
  subcategory.innerHTML = "<option value=''>Select Subcategory</option>";

  Object.keys(CATEGORIES).forEach(c=>{
    const o=document.createElement("option");
    o.value=c;
    o.textContent=c;
    category.appendChild(o);
  });

  category.addEventListener("change",()=>{
    subcategory.innerHTML = "<option value=''>Select Subcategory</option>";
    Object.keys(CATEGORIES[category.value]?.subs || {}).forEach(s=>{
      const o=document.createElement("option");
      o.value=s;
      o.textContent=s;
      subcategory.appendChild(o);
    });
  });

  // SUBMIT
  form.addEventListener("submit", async e=>{
    e.preventDefault();

    const params = new URLSearchParams({
      action:"createWO",
      category:category.value,
      subcategory:subcategory.value,
      client:client.value,
      phone:phone.value,
      description:description.value,
      version:version.value || "v0"
    });

    const res = await fetch(`${SCRIPT_URL}?${params}`);
    const data = await res.json();

    filename.value = data.filename;
    result.style.display="block";
  });

  document.getElementById("copyBtn").onclick = ()=>{
    filename.select();
    document.execCommand("copy");
  };

});
</script>

</body>
</html>
