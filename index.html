<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ZPRINT v2.7 – WO Generator</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{font-family:Arial;padding:20px;max-width:560px}
label{display:block;margin-top:12px}
select,input,button{width:100%;padding:8px;margin-top:4px}
#result{margin-top:20px}
</style>
</head>
<body>

<h2>ZPRINT v2.7 – Work Order</h2>

<label>Category</label>
<select id="category"></select>

<label>Subcategory</label>
<select id="subcategory"></select>

<label>Client</label>
<input id="client">

<label>Phone</label>
<input id="phone">

<label>Description</label>
<input id="description">

<button onclick="createWO()">Generate</button>

<div id="result" style="display:none">
  <p><b>Filename</b></p>
  <input id="filename" readonly>
  <button onclick="copy()">COPY</button>
</div>

<script>
const SCRIPT_URL = ‘https://script.google.com/macros/s/AKfycbwkE9WHkiSqjMZBZsUYIF0BH3ivgbevnYzjqFzvCo0d-gBkje-_-fCwZmOs8vOtAxhO/exec’;

/* categories (same as v2.6.1) */
const CATEGORIES = {
  PVC:{subs:{UV:"UV",PRC:"Print & Cut"}},
  EMB:{subs:{STD:"Standard",PRM:"Premium"}},
  BAN:{subs:{STD:"Standard"}},
  MAP:{subs:{NRM:"Normal"}},
  DTF:{subs:{DTF:"DTF"}},
  CUS:{subs:{CUS:"Custom"}}
};

const cat = document.getElementById("category");
const sub = document.getElementById("subcategory");

cat.innerHTML = "<option></option>";
Object.keys(CATEGORIES).forEach(c=>{
  const o=document.createElement("option");
  o.value=c;o.textContent=c;cat.appendChild(o);
});

cat.onchange=()=>{
  sub.innerHTML="<option></option>";
  Object.keys(CATEGORIES[cat.value].subs).forEach(s=>{
    const o=document.createElement("option");
    o.value=s;o.textContent=s;sub.appendChild(o);
  });
};

function createWO(){
  const p = new URLSearchParams({
    action:"createWO",
    category:cat.value,
    subcategory:sub.value,
    client:client.value,
    phone:phone.value,
    description:description.value,
    version:"v0"
  });

  fetch(SCRIPT_URL+"?"+p)
    .then(r=>r.json())
    .then(d=>{
      filename.value = d.filename;
      result.style.display="block";
    });
}

function copy(){
  filename.select();
  document.execCommand("copy");
}
</script>
</body>
</html>
